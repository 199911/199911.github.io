<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Review of &quot;Avoiding Singleton Abuse&quot; | Coding Sunday</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="The singleton mentioned here is Singleton Design Pattern

Private constructor
Global referal to the instace

Singleton is global variableThe singleton instance can be access in every where. Actually,">
<meta property="og:type" content="article">
<meta property="og:title" content="Review of "Avoiding Singleton Abuse"">
<meta property="og:url" content="http://199911.github.io/review/2016/07/04/singleton/index.html">
<meta property="og:site_name" content="Coding Sunday">
<meta property="og:description" content="The singleton mentioned here is Singleton Design Pattern

Private constructor
Global referal to the instace

Singleton is global variableThe singleton instance can be access in every where. Actually,">
<meta property="og:updated_time" content="2016-07-10T12:13:01.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Review of "Avoiding Singleton Abuse"">
<meta name="twitter:description" content="The singleton mentioned here is Singleton Design Pattern

Private constructor
Global referal to the instace

Singleton is global variableThe singleton instance can be access in every where. Actually,">
  
    <link rel="alternate" href="/atom.xml" title="Coding Sunday" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Coding Sunday</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://199911.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-singleton" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/review/2016/07/04/singleton/" class="article-date">
  <time datetime="2016-07-03T16:00:00.000Z" itemprop="datePublished">2016-07-04</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Review/">Review</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Review of &quot;Avoiding Singleton Abuse&quot;
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>The singleton mentioned here is Singleton Design Pattern</p>
<ul>
<li>Private constructor</li>
<li>Global referal to the instace</li>
</ul>
<h3 id="Singleton-is-global-variable"><a href="#Singleton-is-global-variable" class="headerlink" title="Singleton is global variable"></a>Singleton is global variable</h3><p>The singleton instance can be access in every where. Actually, singleton instance is a group od global variables and methods. If we use singleton instance incorrectly, it will bring the problems from global vairables.</p>
<a id="more"></a> 
<h3 id="Why-global-variable-is-evil"><a href="#Why-global-variable-is-evil" class="headerlink" title="Why global variable is evil?"></a>Why global variable is evil?</h3><p>The root of the problem is, the dependencies of modules on global variable is not clear. It makes the module difficult to understand and test.</p>
<p>For example,<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function foo()&#123;</span><br><span class="line">    global $bar;</span><br><span class="line">    // or</span><br><span class="line">    $bar = Singleton::get_instance()-&gt;bar;</span><br><span class="line">    return ($bar &gt; 10);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>If we run <code>foo()</code>, it can return <code>true</code> or <code>false</code>. As <code>foo()</code> depends on $bar implicitly, we have no idea why the behaviour changed, until we read the source code. This means <code>foo()</code> fail to abstract the detail of implementation.</p>
<h3 id="How-Singleton-solve-the-implicitly-dependency"><a href="#How-Singleton-solve-the-implicitly-dependency" class="headerlink" title="How Singleton solve the implicitly dependency?"></a>How Singleton solve the implicitly dependency?</h3><p>Singleton instance is similar to global variable, but it can solve the implicitly dependency casued by gloabl variable. What we need is “Dependency Injection”. It means we do not depend on the method directly in the implementation, but we pass the dependency using parameters.</p>
<p>Let’s rewrite <code>foo()</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function foo($singleton)&#123;</span><br><span class="line">    $bar = $singleton-&gt;bar;</span><br><span class="line">    return ($bar &gt; 10);</span><br><span class="line">&#125;</span><br><span class="line">// We call foo() like this</span><br><span class="line">foo(Singleton::get_instance());</span><br></pre></td></tr></table></figure></p>
<p>Everytime, we call <code>foo()</code>, we know which module it depends on. We can test the function easily by changing the dependency to a mock instance.</p>
<p>In another aspect, read-only global variable do no harm. If the Singleton’s fields are constant, and methods have no side effect, feel free to use Singleton. But in these case, static class or namespace may be a better choice.</p>
<p>To sum up, advantage of Singleton pattern faciliate dependency injection.</p>
<h3 id="Lifespan-of-object-is-not-a-strong-reason-to-use-singleton"><a href="#Lifespan-of-object-is-not-a-strong-reason-to-use-singleton" class="headerlink" title="Lifespan of object is not a strong reason to use singleton"></a>Lifespan of object is not a strong reason to use singleton</h3><p>If only one object is needed in the whole software does not mean we must use singleton. We can just create an object and store it in somewhere but not in the global scope. We shoud handle the lifespan of the object careful. We cannot escape the responsiblity on lifespan handling by abusing Singleton pattern.</p>
<p>We need to understand what problem does the design pattern want to solve before applying them. “We only need one object” is not a sounded reason to apply Singleton. Software requirement always change, we only need one object now, but we may need more in the future. Applying design pattern in a wrong way make the system unneccesorily complex, increase the difficulty on developmention and maintainance.</p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://www.objc.io/issues/13-architecture/singletons/" target="_blank" rel="external">Avoiding Singleton Abuse</a></p>
<p>PS: In the article they use a built in function <code>dispatch_once()</code>, it makes the refactoring from singleton to object difficult. But in other language, singleton to objects may be a smooth transition</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://199911.github.io/review/2016/07/04/singleton/" data-id="ciq9jkor500010o65vjzxadpb" class="article-share-link">Share</a>
      
        <a href="http://199911.github.io/review/2016/07/04/singleton/#disqus_thread" class="article-comment-link">Comments</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/review/2016/07/10/yahoo-design-part-1/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Review of &quot;Yahoo Design Pattern Library&quot; Part I
        
      </div>
    </a>
  
  
    <a href="/insight/2016/07/03/readings-4/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">文集四</div>
    </a>
  
</nav>

    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Testing -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-4208803683107796"
     data-ad-slot="4489226860"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>  
  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Code/">Code</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Diary/">Diary</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Insight/">Insight</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Review/">Review</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Rust/">Rust</a></li></ul>
    </div>
  </div>


  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/diary/2017/01/08/npm/">npm</a>
          </li>
        
          <li>
            <a href="/diary/2016/12/05/how-to-fallback-to-different-CDN/">How to fallback CSS file to different CDN</a>
          </li>
        
          <li>
            <a href="/insight/2016/11/26/readings-11/">文集十一</a>
          </li>
        
          <li>
            <a href="/review/2016/11/24/CSS-missing-manual-4/">&quot;CSS - the missing manual 2nd edition&quot; CSS Advanced CSS</a>
          </li>
        
          <li>
            <a href="/review/2016/11/20/CSS-missing-manual-3/">&quot;CSS - the missing manual 2nd edition&quot; CSS Page Layout</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 Sunday Ku<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    
<script>
  var disqus_shortname = 'coding-sunday';
  
  var disqus_url = 'http://199911.github.io/review/2016/07/04/singleton/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-74410128-2', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->




  </div>
</body>
</html>